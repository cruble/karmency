<div class="well col-md-10 col-md-offset-1">
    <%= form_for [@coin, @moment], remote: true, class: "form-horizontal" do |f| %>
        <fieldset>
            <legend>Tell us about giving or receiving your Karmency Coin!</legend>
            <div class="form-group">
                <label class="col-lg-2 radio control-label">I...</label>
                <div class="col-lg-10">
                    <div class="radio">
                        <label>
                            <input type="radio" name="optionsRadios" id="optionsRadios1" value="option1" checked="">
                            received a coin
                        </label>
                    </div>
                    <div class="radio">
                        <label>
                            <input type="radio" name="optionsRadios" id="optionsRadios2" value="option2">
                            gave a coin
                        </label>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="moment_description" class="col-lg-2 control-label">Description</label>
                <div class="col-lg-10">
                    <%= f.text_area :description, class: "form-control", placeholder: "E.g., A nice young man gave me his seat on the subway!" %>
                </div>
            </div>
            <div class="form-group">
                <label for="moment_date" class="col-lg-2 control-label">Date</label>
                <div class='col-lg-10'>
                    <%= f.text_field :date, class: "form-control", id: "datetimepicker1", value: @date_today %>
                </div>
            </div>
            <div class="form-group">
                <label for="moment_location" class="col-lg-2 control-label">Location</label>
                <div class='col-lg-10'>
                    <%= f.text_field :location, class: "form-control" %>
                </div>
            </div>

            <div class="form-group">
                <div class="col-lg-10 col-lg-offset-2">
                    <button type="reset" class="btn btn-default">Cancel</button>
                    <% if user_signed_in? %>
                    <button type="submit" class="btn btn-primary">Submit</button>
                    <% else %>
                    <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#myModal2">Sign Up to Save This Moment</button>
                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#myModal">Or Login</button>
                    <% end %>
                </div>
            </div>
        </fieldset>
    <% end %>
</div>

<!-- Modal - Sign_In  -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Sign In To Follow Your Karma</h4>
      </div>
      <div class="modal-body">
      <%= render partial: 'devise/registrations/signin' %>
      </div>
    </div>
  </div>
</div>

<!-- Modal - Sign_Up -->
<div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Sign Up to Track Good Karma</h4>
      </div>
      <div class="modal-body">
      <%= render partial: 'devise/registrations/signup' %>
      </div>
    </div>
  </div>
</div>

<script>
 $(document).ready(function(){
     // initialize date picker
     $('#datetimepicker1').datetimepicker({
         format: 'MM/DD/YY'
     });

     function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(lookupPosition);
        } 
    }
    function lookupPosition(position) {
        var data = {
            lat: position.coords.latitude, 
            lng: position.coords.longitude
        };

        $.getJSON('/locations/lookup', data, function(data){
            $("#moment_location").val(data.location);
        });

    }
    getLocation();

    $('#myModal').on('shown.bs.modal', function () {
      $('#myInput').focus()
    });

 });
</script>



<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>





