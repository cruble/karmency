





<section id="home-parallax" class="parallax" data-stellar-background-ratio="0.5" >
  <div class="container text-center">

    <h1 class="typed-text">Enter the code on your coin:
    </h1>
    <p class="lead"></p>
    <span class="parallax-buttons">
    <div class="input-group col-md-4 col-md-offset-4 form-element" >

        <form action="/coins/show" id="search-form" method="get">
        <input type="text" name="code" placeholder="Search..." class="form-control" data-control="myCoinControl">
        <span class="input-group-btn">

          <button type="submit" class="subscribe-btn btn"><span class="fa fa-search"></span> &nbsp; Find My Coin</button>
        </span> 
        </form>


      </div>
    </span>
  </div>
</section>

<script src="/sky-form/js/jquery.form.min.js" type="text/javascript"></script>
<script src="/sky-form/js/jquery.validate.min.js" type="text/javascript"></script>
<script src="/sky-form/js/jquery-ui.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){

  //set up validation
  $.validator.addMethod("isValidid", function(value, element, arg){
         var url = "/coins/" + $('input[name="code"]').val();
         var isSuccess = false;

         $.ajax({ url: url,
                  dataType: "json",
                  async: false })
            .done(function(data){
                  isSuccess = true;   
            })
            .fail(function(){
              isSuccess = false; 
            });

         return isSuccess;

     }, "Umm, that coin doesn't seem to exist.");

    // only run on submit 
     $.validator.defaults.onfocusout = function (element, event) {
         if ($(element).data("control") === "myCoinControl") return;
         if (!this.checkable(element) && (element.name in this.submitted || !this.optional(element))) {
             this.element(element);
         }
     }

     $.validator.defaults.onkeyup = function (element, event) {
         if ($(element).data("control") === "myCoinControl") return;
         if (event.which === 9 && this.elementValue(element) === "") {
             return;
         }
         else if (element.name in this.submitted || element === this.lastElement) {
             this.element(element);
         }
     }

  // create ajax validator 
    $("#search-form").validate({
         rules: {
             code: {
                 required: true, 
                 rangelength: [4,4],
                 isValidCode: true
             }
         },
         messages: {
             code: {
                 required: "Enter a code", 
                 rangelength: "Code must be 4 digits"
             }
         },
         // Do not change code below
         errorPlacement: function(error, element) {
             error.insertAfter(element.parent());
         }
     });

    // $("button").click(function(){
    //     var url = "/coins/" + $('input[name="code"]').val();
    //     $("form").prop("action", url);
    // });






  
});




  

</script>


